<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>شرطة ريسبكت – تحديث مركز العمليات للشرطة</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-root">
    <!-- انترو -->
    <section class="intro" id="intro">
      <div class="intro-card">
        <h1 class="intro-title">شرطة ريسبكت</h1>
        <p class="intro-subtitle">تحديث مركز العمليات للشرطة</p>
        <button id="enterAppBtn" class="btn btn-primary">
          فتح لوحة العمليات
        </button>
      </div>
    </section>

    <!-- المحتوى الرئيسي -->
    <main class="layout hidden" id="mainLayout">
      <header class="top-bar">
        <div class="top-bar-titles">
          <h2>شرطة ريسبكت</h2>
          <span class="subtitle">تحديث مركز العمليات للشرطة</span>
        </div>
      </header>

      <section class="grid">
        <!-- بطاقة معلومات العمليات -->
        <section class="card">
          <h3 class="card-title">معلومات العمليات</h3>
          <div class="form-grid">
            <div class="field">
              <label>اسم العمليات (اسم + كود)</label>
              <input id="operationsName" class="input" placeholder="مثال: خالد 145" />
            </div>
            <div class="field">
              <label>نائب مركز العمليات (اسم + كود)</label>
              <input id="operationsDeputy" class="input" placeholder="مثال: عبدالله 126" />
            </div>
          </div>

          <div class="chip-list">
            <div class="chip-group">
              <div class="chip-header">
                <span>القيادات (كود)</span>
                <button id="addLeaderBtn" class="btn btn-ghost">إضافة</button>
              </div>
              <div id="leadersList" class="chip-container"></div>
            </div>

            <div class="chip-group">
              <div class="chip-header">
                <span>الضباط (كود)</span>
                <button id="addOfficerBtn" class="btn btn-ghost">إضافة</button>
              </div>
              <div id="officersList" class="chip-container"></div>
            </div>

            <div class="chip-group">
              <div class="chip-header">
                <span>مسؤول الفترة (اسم + كود)</span>
                <button id="addSupervisorBtn" class="btn btn-ghost">إضافة</button>
              </div>
              <div id="supervisorList" class="chip-container"></div>
            </div>

            <div class="chip-group">
              <div class="chip-header">
                <span>ضباط الصف (كود)</span>
                <button id="addNcoBtn" class="btn btn-ghost">إضافة</button>
              </div>
              <div id="ncosList" class="chip-container"></div>
            </div>
          </div>
        </section>

        <!-- بطاقة OCR -->
        <section class="card">
          <h3 class="card-title">استخراج الأكواد من صورة (OCR)</h3>
          <div class="field">
            <label>رفع صورة</label>
            <input id="ocrFileInput" type="file" accept=".png,.jpg,.jpeg,.webp" />
          </div>
          <div class="field">
            <label>أو لصق صورة داخل هذا المربع (Ctrl+V)</label>
            <div id="pasteArea" class="paste-area">
              ألصق صورة هنا من الحافظة
            </div>
          </div>
          <p class="hint">
            يفضل رفع/لصق صورة عالية الجودة. أحيانًا ستحتاج لتعديل النتائج يدويًا قبل الإرسال.
          </p>
          <div class="progress-row">
            <span id="ocrStatusLabel">جاهز</span>
            <div class="progress">
              <div id="ocrProgressBar" class="progress-bar"></div>
            </div>
            <span id="ocrProgressValue">0%</span>
          </div>
        </section>

        <!-- جدول الوحدات -->
        <section class="card full-width">
          <div class="card-header-row">
            <h3 class="card-title">قائمة الوحدات</h3>
            <div class="card-actions">
              <button id="addUnitRowBtn" class="btn btn-secondary">إضافة سطر جديد</button>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="units-table">
              <thead>
                <tr>
                  <th>الكود</th>
                  <th>الحالة</th>
                  <th>الموقع</th>
                  <th>نوع المركبة</th>
                  <th>شريك</th>
                  <th>إجراءات</th>
                </tr>
              </thead>
              <tbody id="unitsTableBody">
                <!-- يملأ عبر JS -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- أزرار الوقت -->
        <section class="card">
          <h3 class="card-title">وقت الاستلام والتسليم</h3>
          <div class="time-row">
            <button id="startTimeBtn" class="btn btn-primary">بدء وقت الاستلام</button>
            <span id="startTimeDisplay" class="time-display">—</span>
          </div>
          <div class="time-row">
            <button id="endTimeBtn" class="btn btn-primary">إنهاء وقت التسليم</button>
            <span id="endTimeDisplay" class="time-display">—</span>
          </div>
        </section>

        <!-- النتيجة النهائية -->
        <section class="card full-width">
          <div class="card-header-row">
            <h3 class="card-title">النتيجة النهائية</h3>
            <button id="copyResultBtn" class="btn btn-ghost">نسخ النص</button>
          </div>
          <textarea id="finalResult" class="result-box"></textarea>
        </section>
      </section>
    </main>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <!-- مودال تعديل الوحدة -->
    <div id="unitModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-dialog">
        <div class="modal-header">
          <h4>تعديل الوحدة</h4>
          <button id="closeModalBtn" class="btn-icon">×</button>
        </div>
        <div class="modal-body">
          <div class="field">
            <label>الكود</label>
            <input id="modalUnitCode" class="input" />
          </div>
          <div class="field">
            <label>الحالة</label>
            <select id="modalUnitStatus" class="input">
              <option>في الخدمة</option>
              <option>مشغول</option>
              <option>مشغول - اختبار</option>
              <option>مشغول - تدريب</option>
              <option>مشغول حالة موجه 10</option>
            </select>
          </div>
          <div class="field">
            <label>الموقع</label>
            <select id="modalUnitLocation" class="input">
              <option>لا شي</option>
              <option>الشمال</option>
              <option>الوسط</option>
              <option>الشرق</option>
              <option>الجنوب</option>
              <option>ساندي</option>
              <option>بوليتو</option>
            </select>
          </div>
          <div class="field">
            <label>نوع المركبة</label>
            <select id="modalUnitType" class="input">
              <option>لا شي</option>
              <option>عادي</option>
              <option>سبيد يونت</option>
              <option>دباب</option>
              <option>الهلي</option>
            </select>
          </div>
          <div class="field speed-type-field hidden" id="speedTypeField">
            <label>نوع سبيد يونت</label>
            <select id="modalSpeedSubType" class="input">
              <option value="">اختر النوع</option>
              <option value="فايبكس">فايبكس</option>
              <option value="موتركس">موتركس</option>
            </select>
          </div>
          <div class="field">
            <label>شريك (كود)</label>
            <input id="modalUnitPartner" class="input" />
          </div>
        </div>
        <div class="modal-footer">
          <button id="saveUnitBtn" class="btn btn-primary">حفظ</button>
          <button id="cancelUnitBtn" class="btn btn-ghost">إلغاء</button>
        </div>
      </div>
    </div>

    <!-- مودال إدخال عنصر (قيادة / ضابط / الخ) -->
    <div id="chipModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-dialog">
        <div class="modal-header">
          <h4 id="chipModalTitle">إضافة</h4>
          <button id="chipCloseBtn" class="btn-icon">×</button>
        </div>
        <div class="modal-body">
          <div class="field">
            <label id="chipModalLabel">القيمة</label>
            <input id="chipModalInput" class="input" />
          </div>
        </div>
        <div class="modal-footer">
          <button id="chipSaveBtn" class="btn btn-primary">حفظ</button>
          <button id="chipCancelBtn" class="btn btn-ghost">إلغاء</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tesseract عبر CDN -->
  <script src="https://unpkg.com/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
